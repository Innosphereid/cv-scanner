sequenceDiagram
    autonumber
    participant C as "Client"
    participant A as "API (Auth Controller/Service)"
    participant D as "DB (Users, OTPReset)"
    participant Q as "Queue (Jobs)"
    participant M as "Mailer (Mailtrap)"

    C->>A: POST /api/v1/auth/forgot-password { email }
    A->>D: Find user by email
    A->>D: Check rate limit (3/hour per user)
    alt Exceeded
      A-->>C: 429 Too Many Requests (Try later)
    else OK
      alt User not found
        A-->>C: 200 OK (If account exists, an OTP has been sent)
      else Found
        A->>A: Generate OTP (6 digits), TTL=5m, single-use
        A->>D: Store hashed OTP + expiry
        A->>Q: Enqueue SendResetOTPEmail(user)
        Q->>M: Send email
        A-->>C: 200 OK (If account exists, an OTP has been sent)
      end
    end


